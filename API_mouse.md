# 鼠标 API

## RX78::Device::ConfigMouseMode<small>设备.配置鼠标模式</small>
| 参数                    | 注释                                                         |
| ----------------------- | ------------------------------------------------------------ |
| mode<small>模式</small> | 可选值为：MouseMode::kRelative <small>#鼠标模式_相对</small>、MouseMode::kAbsolute<small>#鼠标模式_绝对</small>、MouseMode::kBoth <small>#鼠标模式_相对和绝对</small> |

不同的鼠标模式，移动时的行为如下表。

|                                                       | MouseMode::kRelative <small>#鼠标模式_相对</small> | MouseMode::kAbsolute<small>#鼠标模式_绝对</small> | MouseMode::kBoth <small>#鼠标模式_相对和绝对</small> |
| ----------------------------------------------------- | -------------------------------------------------- | ------------------------------------------------- | ---------------------------------------------------- |
| RX78::Device::ToRel<small>RX78设备.到相对坐标</small> | 硬件实现                                           | 通过绝对移动实现                                  | 硬件实现                                             |
| RX78::Device::ToAbs<small>RX78设备.到绝对坐标         | 通过**到相对坐标**实现                             | 硬件实现                                          | 硬件实现                                             |
| RX78::Device::MoveRel<small>RX78设备.相对移动</small> | 通过**到相对坐标**实现                             | 通过到绝对坐标实现                                | 通过**到相对坐标**实现                               |
| RX78::Device::MoveAbs<small>RX78设备.绝对移动</small> | 通过**到相对坐标**实现                             | 通过到绝对坐标实现                                | 通过**到相对坐标**实现                               |



## RX78::Device::GetMouseMode设备.取鼠标模式

| 参数                    | 注释             |
| ----------------------- | ---------------- |
| mode<small>模式</small> | 返回当前鼠标模式 |
## RX78::Device::LeftDown<small>RX78设备.左键按下</small>

## RX78::Device::LeftUp<small>RX78设备.左键弹起</small>
## RX78::Device::LeftClick<small>RX78设备.左键单击</small>
| 参数                                                | 注释                                                        |
| --------------------------------------------------- | ----------------------------------------------------------- |
| sleep_after_down_range<small>按下后延迟范围</small> | 默认值为 { 50, 80 }，即大于等于 50 ms，小于等于 80 ms。     |
| sleep_after_up_range<small>弹起后延迟范围</small>   | 默认值为 { 500, 900 }，即大于等于 500 ms，小于等于 900 ms。 |

## RX78::Device::LeftDoubleClick<small>RX78设备.左键双击</small>
| 参数                                                         | 注释                                                        |
| ------------------------------------------------------------ | ----------------------------------------------------------- |
| sleep_after_first_down_range<small>第一次按下后延迟范围</small> | 默认值为 { 50, 80 }，即大于等于 50 ms，小于等于 80 ms。     |
| sleep_after_first_up_range<small>第一次弹起后延迟范围</small> | 默认值为 { 60, 110 }，即大于等于 60 ms，小于等于 110 ms。   |
| sleep_after_second_down_range<small>第二次按下后延迟范围</small> | 默认值为 { 50, 80 }，即大于等于 50 ms，小于等于 80 ms。     |
| sleep_after_second_up_range<small>第二次弹起后延迟范围</small> | 默认值为 { 500, 900 }，即大于等于 500 ms，小于等于 900 ms。 |


## RX78::Device::RightDown<small>RX78设备.右键按下</small>
## RX78::Device::RightUp<small>RX78设备.右键弹起</small>
## RX78::Device::RightClick<small>RX78设备.右键单击</small>
| 参数                                                | 注释                                                        |
| --------------------------------------------------- | ----------------------------------------------------------- |
| sleep_after_down_range<small>按下后延迟范围</small> | 默认值为 { 50, 80 }，即大于等于 50 ms，小于等于 80 ms。     |
| sleep_after_up_range<small>弹起后延迟范围</small>   | 默认值为 { 500, 900 }，即大于等于 500 ms，小于等于 900 ms。 |

## RX78::Device::RightDoubleClick<small>RX78设备.右键双击</small>
| 参数                                                         | 注释                                                        |
| ------------------------------------------------------------ | ----------------------------------------------------------- |
| sleep_after_first_down_range<small>第一次按下后延迟范围</small> | 默认值为 { 50, 80 }，即大于等于 50 ms，小于等于 80 ms。     |
| sleep_after_first_up_range<small>第一次弹起后延迟范围</small> | 默认值为 { 60, 110 }，即大于等于 60 ms，小于等于 110 ms。   |
| sleep_after_second_down_range<small>第二次按下后延迟范围</small> | 默认值为 { 50, 80 }，即大于等于 50 ms，小于等于 80 ms。     |
| sleep_after_second_up_range<small>第二次弹起后延迟范围</small> | 默认值为 { 500, 900 }，即大于等于 500 ms，小于等于 900 ms。 |

## RX78::Device::MiddleDown<small>RX78设备.中键按下</small>
## RX78::Device::MiddleUp<small>RX78设备.中键弹起</small>
## RX78::Device::MiddleClick<small>RX78设备.中键单击</small>
| 参数                                                | 注释                                                        |
| --------------------------------------------------- | ----------------------------------------------------------- |
| sleep_after_down_range<small>按下后延迟范围</small> | 默认值为 { 50, 80 }，即大于等于 50 ms，小于等于 80 ms。     |
| sleep_after_up_range<small>弹起后延迟范围</small>   | 默认值为 { 500, 900 }，即大于等于 500 ms，小于等于 900 ms。 |

## RX78::Device::MiddleDoubleClick<small>RX78设备.中键双击</small>
| 参数                                                         | 注释                                                        |
| ------------------------------------------------------------ | ----------------------------------------------------------- |
| sleep_after_first_down_range<small>第一次按下后延迟范围</small> | 默认值为 { 50, 80 }，即大于等于 50 ms，小于等于 80 ms。     |
| sleep_after_first_up_range<small>第一次弹起后延迟范围</small> | 默认值为 { 60, 110 }，即大于等于 60 ms，小于等于 110 ms。   |
| sleep_after_second_down_range<small>第二次按下后延迟范围</small> | 默认值为 { 50, 80 }，即大于等于 50 ms，小于等于 80 ms。     |
| sleep_after_second_up_range<small>第二次弹起后延迟范围</small> | 默认值为 { 500, 900 }，即大于等于 500 ms，小于等于 900 ms。 |

## RX78::Device::ReleaseAllButton<small>RX78设备.释放所有鼠标按键</small>

在出现鼠标按键出现异常时，可以调用该方法恢复。

## RX78::Device::Scroll<small>RX78设备.滚动</small>

滚动鼠标滚轮。

| 参数                   | 注释                 |
| ---------------------- | -------------------- |
| value<small>值</small> | 向上为正，向下为负。 |



## RX78::Device::ToRel<small>RX78设备.到相对坐标</small>
将光标到置于当前坐标的位置 (x, y) 处，无移动轨迹。

| 参数 | 注释       |
| ---- | ---------- |
| x    | x 轴移动量 |
| y    | y 轴移动量 |



## RX78::Device::ToAbs<small>RX78设备.到绝对坐标</small>
将光标置于相对于坐标 (0, 0) 的位置 (x, y) 处，无移动轨迹。使用此方法前需要先[设置目标机器分辨率]()，否则返回 `RX78::Result::kInvalidResolutionValue`或`RX78结果_无效分辨率`。

| 参数 | 注释   |
| ---- | ------ |
| x    | x 坐标 |
| y    | y 坐标 |


## RX78::Device::MoveRel<small>RX78设备.相对移动</small>

使用数学方程模拟移动轨迹移动到相对坐标。

轨迹计算方程为 `a1 sin(b1 v) + a2 sin(b2 v)`，v 表示光标到目标的直线移动量。速度由三次贝塞尔曲线计算得到。

| 参数                               | 注释                                                         |
| ---------------------------------- | ------------------------------------------------------------ |
| x                                  | x 轴移动量                                                   |
| y                                  | y 轴移动量                                                   |
| sample_rate<small>采样比例</small> | 此系数 * 到目标的直线距离 = 用几个点模拟轨迹，默认为 0.2。   |
| sleep<small>延时</small>           | 每个模拟点之间的延时，默认为 10。                            |
| a1                                 | 此值为随机范围，默认值为 { 1, 2 }，表示区间 [1, 2)。         |
| b1                                 | 此值为随机范围，默认值为 { 0.001, 0.04 }，表示区间 [0.001, 0.04)。 |
| a2                                 | 此值为随机范围，默认值为 { 0.5, 1.5 }，表示区间 [0.5, 1.5)。 |
| b2                                 | 此值为随机范围，默认值为 { 0.001, 0.06 }，表示区间 [0.001, 0.06)。 |
| p1                                 | 此值为随机范围，默认值为 { 0.001, 1 }，表示区间 [0.001, 1)。 |
| p2                                 | 此值为随机范围，默认值为 { 0.001, 1 }，表示区间 [0.001, 1)。 |

## RX78::Device::MoveAbs<small>RX78设备.绝对移动</small>

使用数学方程模拟移动轨迹移动到绝对坐标。

轨迹计算方程为 `a1 sin(b1 v) + a2 sin(b2 v)`，v 表示光标到目标的直线移动量。速度由三次贝塞尔曲线计算得到。

| 参数                               | 注释                                                         |
| ---------------------------------- | ------------------------------------------------------------ |
| x                                  | x 轴移动量                                                   |
| y                                  | y 轴移动量                                                   |
| sample_rate<small>采样比例</small> | 此系数 * 到目标的直线距离 = 用几个点模拟轨迹，默认为 0.2。   |
| sleep<small>延时</small>           | 每个模拟点之间的延时，默认为 10。                            |
| a1                                 | 此值为随机范围，默认值为 { 1, 2 }，表示区间 [1, 2)。         |
| b1                                 | 此值为随机范围，默认值为 { 0.001, 0.04 }，表示区间 [0.001, 0.04)。 |
| a2                                 | 此值为随机范围，默认值为 { 0.5, 1.5 }，表示区间 [0.5, 1.5)。 |
| b2                                 | 此值为随机范围，默认值为 { 0.001, 0.06 }，表示区间 [0.001, 0.06)。 |
| p1                                 | 此值为随机范围，默认值为 { 0.001, 1 }，表示区间 [0.001, 1)。 |
| p2                                 | 此值为随机范围，默认值为 { 0.001, 1 }，表示区间 [0.001, 1)。 |

## RX78::Device::Trace<small>RX78设备.沿轨迹移动</small>

根据传入的轨迹数据进行移动，此方法为相对移动。

| 参数                           | 注释                                                         |
| ------------------------------ | ------------------------------------------------------------ |
| offsets<small>轨迹数据</small> | 轨迹数据，易语言传递二维数组，VC++ 传递 vector&lt;RX78::0ffset&gt;，如：<br>&nbsp;&nbsp;&nbsp;&nbsp;{ {0, 1}, {1, 3}, {2, 3} }。 |
| sleep<small>延时</small>       | 每个点之间的延时。                                           |

## RX78::Device::Trace

重载版本。根据传入的轨迹数据进行移动，此方法为相对移动。

| 参数    | 注释                                                         |
| ------- | ------------------------------------------------------------ |
| offsets | 轨迹数据，VC++ 传递 int16_t\[\]\[2\]，如：<br>&nbsp;&nbsp;&nbsp;&nbsp;{ {0, 1}, {1, 3}, {2, 3} }。 |
| size    | 轨迹数据大小，如：{ {0, 1}, {1, 3}, {2, 3} }，大小为 3。     |
| sleep   | 每个点之间的延时。                                           |